{"version":3,"sources":["lazy.disqus.js"],"names":["doc","win","script","isLoaded","shortname","element","eventCallback","threashold","innerHeight","lazyLoad","getBoundingClientRect","top","removeEventListener","createElement","async","src","setAttribute","Date","innerHTML","head","body","appendChild","addEventListener","disqusLazy","opts","fn","delay","timeout","lastCalled","throttle","now","remaining","args","arguments","clearTimeout","setTimeout","apply","getElementById","document","window"],"mappings":"CACC,SAAUA,EAAKC,GACZ,IAAIC,EACAC,EACAC,EACAC,EACAC,EACAC,EAA+B,IAAlBN,EAAIO,YAmCrB,SAASC,KACAN,GALKE,EAAQK,wBAAwBC,IAC7BV,EAAIO,aAAeD,IAK5BK,oBAAoB,SAAUN,GAC9BM,oBAAoB,SAAUN,IAE9BJ,EAASF,EAAIa,cAAc,WACpBC,OAAQ,EACfZ,EAAOa,IAAM,KAAOX,EAAY,uBAChCF,EAAOc,aAAa,kBAAmB,IAAIC,MAE3CZ,EAAQa,UAAY,uBAClBlB,EAAImB,MAAQnB,EAAIoB,MAAMC,YAAYnB,GAEpCC,GAAW,GA9CfE,IACAiB,iBAAiB,SAAUhB,GAC3BgB,iBAAiB,SAAUhB,IAgD/BL,EAAIsB,WAAa,SAASC,GA7C1B,IAAkBC,EAAIC,EAEdC,EADAC,EA8CJxB,GADAoB,EAAOA,GAAQ,IACEpB,UA/CHqB,EAgDWhB,EAhDPiB,EAgDiBF,EAAKK,UAAY,IA/ChDD,EAAa,EA+CjBtB,EA5CO,WACH,IAAIwB,GAAO,IAAIb,KACXc,EAAYL,GAASI,EAAMF,GAC3BI,EAAOC,UAEXC,aAAaP,GAEG,EAAZI,EACAJ,EAAUQ,WAAW,WACjBP,EAAaE,EACbL,EAAGW,MAAM,KAAMJ,IAChBD,IAEHH,EAAaE,EACbL,EAAGW,MAAM,KAAMJ,KA+BvB3B,EAAUmB,EAAKnB,SAAWL,EAAIqC,eAAe,iBAC7C9B,EAAaiB,EAAKjB,YAAgC,IAAlBN,EAAIO,YAEhCH,IACAiB,iBAAiB,SAAUhB,GAC3BgB,iBAAiB,SAAUhB,KAnEtC,CAsEEgC,SAAUC","file":"lazy.disqus.js","sourcesContent":["// https://www.samclarke.com/lazy-loading-disqus/\n;(function(doc, win) {\n    var script\n    var isLoaded\n    var shortname\n    var element\n    var eventCallback\n    var threashold = win.innerHeight * 0.75\n\n    if (element) {\n        addEventListener('scroll', eventCallback)\n        addEventListener('resize', eventCallback)\n    }\n\n    function throttle(fn, delay) {\n        var lastCalled = 0\n        var timeout\n\n        return function() {\n            var now = +new Date()\n            var remaining = delay - (now - lastCalled)\n            var args = arguments\n\n            clearTimeout(timeout)\n\n            if (remaining > 0) {\n                timeout = setTimeout(function() {\n                    lastCalled = now\n                    fn.apply(null, args)\n                }, remaining)\n            } else {\n                lastCalled = now\n                fn.apply(null, args)\n            }\n        }\n    }\n\n    function isPassedThreashold() {\n        var top = element.getBoundingClientRect().top\n        return top - win.innerHeight <= threashold\n    }\n\n    function lazyLoad() {\n        if (!isLoaded && isPassedThreashold()) {\n            removeEventListener('scroll', eventCallback)\n            removeEventListener('resize', eventCallback)\n\n            script = doc.createElement('script')\n            script.async = true\n            script.src = '//' + shortname + '.disqus.com/embed.js'\n            script.setAttribute('data-timestamp', +new Date())\n\n            element.innerHTML = 'Loading comments...'\n            ;(doc.head || doc.body).appendChild(script)\n\n            isLoaded = true\n        }\n    }\n\n    win.disqusLazy = function(opts) {\n        opts = opts || {}\n        shortname = opts.shortname\n        eventCallback = throttle(lazyLoad, opts.throttle || 100)\n        element = opts.element || doc.getElementById('disqus_thread')\n        threashold = opts.threashold || win.innerHeight * 0.75\n\n        if (element) {\n            addEventListener('scroll', eventCallback)\n            addEventListener('resize', eventCallback)\n        }\n    }\n})(document, window)\n"]}